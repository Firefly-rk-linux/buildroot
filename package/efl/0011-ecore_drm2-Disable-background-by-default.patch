From 82281a5dcb250fa28460579615d4a754dac08583 Mon Sep 17 00:00:00 2001
From: Jeffy Chen <jeffy.chen@rock-chips.com>
Date: Fri, 1 Jul 2022 19:20:17 +0800
Subject: [PATCH 11/12] ecore_drm2: Disable background by default

Signed-off-by: Jeffy Chen <jeffy.chen@rock-chips.com>
---
 src/lib/ecore_drm2/ecore_drm2_device.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/lib/ecore_drm2/ecore_drm2_device.c b/src/lib/ecore_drm2/ecore_drm2_device.c
index e8f5347be3..2e33232f86 100644
--- a/src/lib/ecore_drm2/ecore_drm2_device.c
+++ b/src/lib/ecore_drm2/ecore_drm2_device.c
@@ -272,7 +272,8 @@ _drm2_atomic_state_crtc_fill(Ecore_Drm2_Crtc_State *cstate, int fd)
              cstate->active.value = oprops->prop_values[i];
              DBG("\t\t\tValue: %lu", (long)cstate->active.value);
           }
-        else if (!strcmp(prop->name, "BACKGROUND_COLOR"))
+        else if (!strcmp(prop->name, "BACKGROUND_COLOR") &&
+                 getenv("ECORE_DRM2_BACKGROUND"))
           {
              cstate->background.id = prop->prop_id;
              cstate->background.value = oprops->prop_values[i];
-- 
2.20.1

